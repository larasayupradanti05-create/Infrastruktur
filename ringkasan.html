<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Interaktif Jalan UPNVJT</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body{font-family:'Poppins',sans-serif;background:#f8f9fa;}
.sidebar{height:100vh;width:250px;background:#0d6efd;color:white;position:fixed;padding:1rem;display:flex;flex-direction:column;}
.sidebar h4{text-align:center;margin-bottom:2rem;font-weight:700;}
.sidebar a{color:#dbe4ff;text-decoration:none;padding:10px 15px;margin-bottom:5px;border-radius:8px;display:block;transition:0.2s;}
.sidebar a:hover,.sidebar a.active{background:#ffffff22;color:#fff;}
.main-content{margin-left:260px;padding:2rem;}
.card{border-radius:1rem;box-shadow:0 4px 15px rgba(0,0,0,0.05);margin-bottom:1.5rem;padding:1rem;}
.chart-container{width:100%;max-width:900px;margin:2rem auto;}
</style>
</head>
<body>
<div class="sidebar">
<h4><i class="bi bi-geo-alt-fill"></i> Jalan UPNVJT</h4>
<a href="index.html">Dashboard</a>
<a href="data-responden.html">Data Responden</a>
<a href="analisis 1.html">Analisis</a>
<a href="#" class="active">Ringkasan</a>
<a href="interaktif.html">Interaktif</a>
<a href="#"><i class="bi bi-info-circle me-2"></i> Tentang</a>
</div>

<div class="main-content">
<h2 class="fw-bold mb-4 text-primary">Ringkasan Statistik Survei Jalan</h2>

<div id="summaryArea"></div>
<p id="infoText" class="text-danger fw-bold mt-3"></p>
</div>

<script>
// Fungsi statistik
function mean(arr){ return arr.reduce((a,b)=>a+b,0)/arr.length; }
function median(arr){ const s=[...arr].sort((a,b)=>a-b); const mid=Math.floor(s.length/2); return s.length %2 ? s[mid] : (s[mid-1]+s[mid])/2; }
function mode(arr){ const counts={}; arr.forEach(v=>counts[v]=(counts[v]||0)+1); let max=0, res=[]; for(const [k,v] of Object.entries(counts)){ if(v>max){ max=v; res=[k]; } else if(v===max){ res.push(k); } } return res.join(", "); }
function stdDev(arr){ const m=mean(arr); return Math.sqrt(arr.reduce((a,b)=>a+(b-m)**2,0)/arr.length).toFixed(2); }

// Ambil data dari localStorage
const dataStr = localStorage.getItem("surveyData"); 
const summaryArea = document.getElementById("summaryArea");
const infoText = document.getElementById("infoText");

if(!dataStr){
    infoText.textContent = "⚠️ Data tidak ditemukan. Silakan upload CSV di halaman Dashboard terlebih dahulu.";
} else {
    const data = JSON.parse(dataStr);
    const keys = Object.keys(data[0]);
    const ignoreCols = ["NPM","Nomor WhatsApp","No HP"]; // abaikan kolom sensitif

    keys.forEach(k=>{
        if(ignoreCols.includes(k)) return;
        const vals = data.map(r=>parseFloat(r[k])).filter(v=>!isNaN(v));
        if(vals.length>0){
            const card = document.createElement("div");
            card.className="card";
            card.innerHTML = `
                <h5>${k}</h5>
                <p><b>Mean:</b> ${mean(vals).toFixed(2)} | <b>Median:</b> ${median(vals)} | <b>Mode:</b> ${mode(vals)}<br>
                <b>Min:</b> ${Math.min(...vals)} | <b>Max:</b> ${Math.max(...vals)} | <b>Std Dev:</b> ${stdDev(vals)}</p>
            `;
            summaryArea.appendChild(card);
        }
    });
}
</script>
</body>
</html>
